# 微信聊天记录管理程序

一个用于管理微信聊天记录的 Windows 桌面工具。支持选择性隐藏和还原聊天记录。

## ⚠️ 免责声明

**重要提示：请在使用前仔细阅读**

1. 本工具仅供个人管理自己的聊天记录使用
2. 使用本工具可能违反微信服务条款
3. 作者不对任何数据丢失或账号问题承担责任
4. 请自行备份重要数据
5. 本工具不会上传任何数据到网络

**继续使用即表示您已了解并接受以上风险。**

## 功能特性

- ✅ 自动检测微信数据目录
- ✅ 从微信进程提取解密密钥
- ✅ 查看联系人和群聊列表
- ✅ **安全模式 (Mode A)**: 只读提取到本地加密存储
- ✅ **便捷模式 (Mode B)**: 自动备份 + 删除/还原（需确认风险）
- ✅ 搜索已提取的聊天记录
- ✅ 导出为 TXT 文件
- ✅ 应用密码保护

## 系统要求

- Windows 10/11
- Python 3.10+
- 微信 PC 版（用于密钥提取）

## 安装

### 1. 克隆或下载项目
```bash
git clone <repository-url>
cd wechat-chat-manager
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行程序
```bash
# Windows
run.bat

# 或手动运行
python -m uvicorn wechat_manager.api.main:app --host 127.0.0.1 --port 8000
```

### 4. 打开浏览器
访问 http://127.0.0.1:8000

## 使用说明

### 首次使用

1. 运行程序后，首先设置应用密码
2. 确保微信 PC 版正在运行
3. 点击"提取密钥"获取解密密钥
4. 程序会自动检测微信数据目录

### 安全模式 (推荐)

1. 选择要隐藏的联系人/群聊
2. 点击"提取"将聊天记录复制到加密存储
3. 手动在微信中删除这些聊天（微信原数据不变）
4. 随时可以在程序中查看已提取的聊天记录

### 便捷模式 (高风险)

1. 确保微信已完全关闭
2. 切换到便捷模式（需确认风险）
3. 选择联系人后点击"隐藏"
4. 程序会自动：创建备份 → 提取 → 删除原记录
5. 需要时可以"还原"到微信数据库

## 杀毒软件说明

由于本工具需要读取微信进程内存来获取解密密钥，部分杀毒软件可能会误报。这是正常现象。

如遇到杀毒软件拦截，请：
1. 将程序目录添加到杀毒软件白名单
2. 或临时禁用实时保护

## 数据安全

- 所有提取的聊天记录使用 AES 加密存储
- 密钥使用 PBKDF2 从您的密码派生
- 微信解密密钥使用系统凭据管理器存储
- 不存储任何明文密码或密钥

## 技术架构

- 后端: Python + FastAPI
- 前端: HTML + TailwindCSS + Alpine.js
- 加密: SQLCipher / PyCryptodome
- 存储: SQLite (加密)

## 常见问题

**Q: 提取密钥失败？**
A: 确保微信 PC 版正在运行，且程序以管理员权限运行。

**Q: 找不到微信目录？**
A: 手动指定路径，通常在 `C:\Users\<用户名>\Documents\WeChat Files`

**Q: 便捷模式操作失败？**
A: 确保微信已完全关闭（检查任务管理器）

## 许可证

MIT License - 仅供个人非商业使用

## 致谢

- [PyWxDump](https://github.com/xaoyaoo/PyWxDump) - 密钥提取参考
- [WeChatMsg](https://github.com/LC044/WeChatMsg) - 数据库结构参考
