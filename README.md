# 微信聊天记录管理程序

一个用于管理微信聊天记录的 Windows 桌面工具。支持读取、提取和导出聊天记录。

## ⚠️ 免责声明

**重要提示：请在使用前仔细阅读**

1. 本工具仅供个人管理自己的聊天记录或科研、学习交流使用，严禁任何人将本项目用于任何形式的商业用途或倒卖行为，一经发现，作者保留追究法律责任的权利。
2. 使用本工具可能违反微信服务条款。用户在使用本软件时，需自行承担由于违反腾讯公司《微信软件许可及服务协议》可能导致的封号或法律风险。
3. 作者不对任何数据丢失或账号问题承担法律责任。
4. 请自行备份重要数据。
5. 本工具不会上传任何数据到网络。

**继续使用即表示您已了解并接受以上风险。**

## 功能特性

- ✅ **自动检测**: 自动识别微信数据目录（支持 3.x 及 4.x 路径）。
- ✅ **手动密钥**: 支持手动输入 64 位十六进制解密密钥。
- ✅ **联系人管理**: 查看联系人和群聊列表。
- ✅ **安全提取 (Mode A)**: 将聊天记录提取到本地加密存储，支持增量同步。
- ✅ **微信 4.x 支持**: 支持新版微信的 `Msg_{md5}.db` 表结构及同步机制。
- ✅ **搜索与导出**: 搜索已提取的记录并导出为 TXT 文件。
- ✅ **隐私保护**: 应用密码保护，本地数据 AES 加密。

## 系统要求

- Windows 10/11
- Python 3.10+
- 微信 PC 版 (仅支持 4.x 版本)

## 安装

### 1. 克隆项目
```bash
git clone <repository-url>
cd wechat-chat-manager
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行程序
```bash
# 使用批处理文件
run.bat

# 或手动运行
python -m uvicorn wechat_manager.api.main:app --host 127.0.0.1 --port 8000
```

### 4. 访问界面
在浏览器中打开 [http://127.0.0.1:8000](http://127.0.0.1:8000)

## 使用说明

### 密钥获取与输入
由于自动提取密钥功能已移除，您需要手动获取并输入 64 位十六进制密钥：
1. 使用第三方工具（如 PyWxDump 等）获取微信数据库密钥。
2. 在程序设置界面输入该密钥。
3. 密钥将安全地存储在系统凭据管理器（Keyring）中。

### 聊天记录提取
1. 选择要备份的联系人或群聊。
2. 点击“提取”按钮，程序会将记录同步到本地加密数据库。
3. 提取后的记录存储在：`%USERPROFILE%\.wechat_manager\storage`。

## 已知限制
- **媒体文件**: 目前仅支持文本消息提取，暂不支持图片、视频等媒体文件的直接解码查看。
- **本地缓存**: 提取的数据存储在用户目录下的 `.wechat_manager` 文件夹中，请勿随意删除。
- **手动操作**: 不再支持自动删除或还原微信原始数据库记录（原 Mode B 已移除）。

## 技术架构
- **后端**: Python + FastAPI
- **前端**: HTML + TailwindCSS + Alpine.js
- **加密**: PyCryptodome (AES-256)
- **压缩**: Zstandard (用于 Weixin 4.x 消息解压)
- **存储**: SQLite (加密)

## 许可证
GNU General Public License v3.0 - 仅供个人非商业使用